<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · JWAS.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JWAS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">JWAS.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/theory/">Some Theory</a></li><li><a class="tocitem" href="../../citing/citing/">Citing</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../getstarted/">Get Started</a></li><li><a class="tocitem" href="../workflow/">Workflow</a></li><li><a class="tocitem" href="../public/">Public</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Index-1"><span>Index</span></a></li><li><a class="tocitem" href="#Internal-interface-1"><span>Internal interface</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions/">Frequently Asked Questions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/reworkhow/JWAS.jl/blob/master/docs/src/manual/internals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal-functions-1"><a class="docs-heading-anchor" href="#Internal-functions-1">Internal functions</a><a class="docs-heading-anchor-permalink" href="#Internal-functions-1" title="Permalink"></a></h1><p>Documentation for JWAS.jl&#39;s internal (private) interface, which are not available to general users. These internal functions are small blocks that public function build on.</p><p>&lt;!–-</p><h2 id="Index-1"><a class="docs-heading-anchor" href="#Index-1">Index</a><a class="docs-heading-anchor-permalink" href="#Index-1" title="Permalink"></a></h2><ul><li><a href="#DataAPI.describe-Tuple{JWAS.MME}"><code>DataAPI.describe</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any,AbstractString,Vararg{AbstractString,N} where N}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any,Any}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.GWAS-Tuple{Any}"><code>JWAS.GWAS</code></a></li><li><a href="#JWAS.PedModule.get_pedigree-Tuple{AbstractString}"><code>JWAS.PedModule.get_pedigree</code></a></li><li><a href="#JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}"><code>JWAS.PedModule.getinfo</code></a></li><li><a href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a></li><li><a href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a></li><li><a href="#JWAS.add_term-Tuple{Any,AbstractString}"><code>JWAS.add_term</code></a></li><li><a href="#JWAS.build_model"><code>JWAS.build_model</code></a></li><li><a href="#JWAS.getEBV-NTuple{4,Any}"><code>JWAS.getEBV</code></a></li><li><a href="#JWAS.getMCMCinfo-Tuple{Any}"><code>JWAS.getMCMCinfo</code></a></li><li><a href="#JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.getMME</code></a></li><li><a href="#JWAS.get_outputX_others-Tuple{Any,Any}"><code>JWAS.get_outputX_others</code></a></li><li><a href="#JWAS.outputEBV-Tuple{Any,Any}"><code>JWAS.outputEBV</code></a></li><li><a href="#JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.outputMCMCsamples</code></a></li><li><a href="#JWAS.output_MCMC_samples"><code>JWAS.output_MCMC_samples</code></a></li><li><a href="#JWAS.output_MCMC_samples_setup"><code>JWAS.output_MCMC_samples_setup</code></a></li><li><a href="#JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}"><code>JWAS.output_location_parameters_samples</code></a></li><li><a href="#JWAS.runMCMC-Tuple{JWAS.MME,Any}"><code>JWAS.runMCMC</code></a></li><li><a href="#JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.set_covariate</code></a></li><li><a href="#JWAS.set_random"><code>JWAS.set_random</code></a></li><li><a href="#JWAS.set_random"><code>JWAS.set_random</code></a></li><li><a href="#JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.showMME</code></a></li><li><a href="#JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.solve</code></a></li><li><a href="#JWAS.transubstrarr-Tuple{Any}"><code>JWAS.transubstrarr</code></a></li></ul><h2 id="Internal-interface-1"><a class="docs-heading-anchor" href="#Internal-interface-1">Internal interface</a><a class="docs-heading-anchor-permalink" href="#Internal-interface-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DataAPI.describe-Tuple{JWAS.MME}" href="#DataAPI.describe-Tuple{JWAS.MME}"><code>DataAPI.describe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">describe(model::MME)</code></pre><ul><li>Print out model information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/JWAS.jl#L613-L617">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any,AbstractString,Vararg{AbstractString,N} where N}" href="#JWAS.GWAS-Tuple{Any,AbstractString,Vararg{AbstractString,N} where N}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(model,map_file,marker_effects_file...;
     window_size = &quot;1 Mb&quot;,sliding_window = false,
     GWAS = true, threshold = 0.001,
     genetic_correlation = false,
     header = true)</code></pre><p>run genomic window-based GWAS</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>model</strong> is either the model::MME used in analysis or the genotype cavariate matrix M::Array</li><li><strong>map_file</strong> has the (sorted) marker position information with delimiter &#39;,&#39;. If the map file is not provided, a fake map file will be generated with 100 markers in each 1 Mb window.</li><li>If two <strong>marker<em>effects</em>file</strong> are provided, and <strong>genetic_correlation</strong> = true, genomic correlation for each window is calculated.</li><li>Statistics are computed for nonoverlapping windows of size <em>window_size</em> by default. If <strong>sliding_window</strong> = true, those for overlapping sliding windows are calculated.</li><li>map file format:</li></ul><pre><code class="language-none">markerID,chromosome,position
m1,1,16977
m2,1,434311
m3,1,1025513
m4,2,70350
m5,2,101135</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/3.GWAS/src/GWAS.jl#L33-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any,Any}" href="#JWAS.GWAS-Tuple{Any,Any}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(marker_effects_file,model;header=true,window_size=100,threshold=0.001)</code></pre><p>run genomic window-based GWAS without a map file</p><ul><li>MCMC samples of marker effects are stored in <strong>marker<em>effects</em>file</strong> with delimiter &#39;,&#39;.</li><li><strong>window_size</strong> is either a constant (identical number of markers in each window) or an array of number of markers in each window</li><li><strong>model</strong> is either the model::MME used in analysis or the genotypic covariate matrix M::Array</li><li>File format:</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/3.GWAS/src/GWAS_deprecated.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.GWAS-Tuple{Any}" href="#JWAS.GWAS-Tuple{Any}"><code>JWAS.GWAS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">GWAS(marker_effects_file;header=true)</code></pre><p>Compute the model frequency for each marker (the probability the marker is included in the model) using samples of marker effects stored in <strong>marker<em>effects</em>file</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/3.GWAS/src/GWAS.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.add_genotypes" href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_genotypes(mme::MME,file,G;separator=&#39; &#39;,header=true,center=true,G_is_marker_variance=false,df=4.0)</code></pre><ul><li><p>Get marker informtion from a genotype file. This file needs to be column-wise sorted by marker positions.</p></li><li><p><strong>G</strong> is the mean for the prior assigned for the genomic variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes).</p></li><li><p>File format:</p></li></ul><pre><code class="language-none">Animal,marker1,marker2,marker3,marker4,marker5
S1,1,0,1,1,1
D1,2,0,2,2,1
O1,1,2,0,1,0
O3,0,0,2,1,1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/markers/readgenotypes.jl#L40-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.add_genotypes" href="#JWAS.add_genotypes"><code>JWAS.add_genotypes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_genotypes(mme::MME,M,G;header=false,center=true,rowID=false,G_is_marker_variance=false,df=4)</code></pre><ul><li>Get marker informtion from an nxp Matrix M of genotypes (Array or DataFrame), where n is the number of individuals and p is the number of markers. This matrix needs to be column-wise sorted by marker positions.</li><li><strong>G</strong> is the mean for the prior assigned for the genomic variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes)</li><li>rowID is a vector of individual IDs, e.g.,rowID=[&quot;a1&quot;,&quot;b2&quot;,&quot;c1&quot;]; if it is omitted, IDs will be set to 1:n</li><li>header is a header vector such as [&quot;id&quot;; &quot;mrk1&quot;; &quot;mrk2&quot;;...;&quot;mrkp&quot;]. If omitted, marker names will be set to 1:p</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/markers/readgenotypes.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.build_model" href="#JWAS.build_model"><code>JWAS.build_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">build_model(model_equations::AbstractString,R=false; df::AbstractFloat=4.0)</code></pre><ul><li>Build a model from <strong>model equations</strong> with the residual variance <strong>R</strong>. In Bayesian analysis, <strong>R</strong> is the mean for the prior assigned for the residual variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>R</strong> is not provided, a value is calculated from responses (phenotypes).</li><li>By default, all variabels in model<em>equations are factors (categorical) and fixed. Set variables to be covariates (continuous) or random using functions `set</em>covariate()<code>or</code>set_random()`.</li></ul><pre><code class="language-julia">#single-trait
model_equations = &quot;BW = intercept + age + sex&quot;
R               = 6.72
models          = build_model(model_equations,R);

#multi-trait
model_equations = &quot;BW = intercept + age + sex
                   CW = intercept + litter&quot;;
R               = [6.72   24.84
                   24.84  708.41]
models          = build_model(model_equations,R);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/build_MME.jl#L14-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.getEBV-NTuple{4,Any}" href="#JWAS.getEBV-NTuple{4,Any}"><code>JWAS.getEBV</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getEBV(model::MME,sol,α,traiti)</code></pre><p>(internal function) Get breeding values for individuals defined by outputEBV(), defaulting to all genotyped individuals. This function is used inside MCMC functions for one MCMC samples from posterior distributions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L169-L175">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.outputEBV-Tuple{Any,Any}" href="#JWAS.outputEBV-Tuple{Any,Any}"><code>JWAS.outputEBV</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">outputEBV(model,IDs::Array)</code></pre><p>Output estimated breeding values and prediction error variances for IDs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}" href="#JWAS.outputMCMCsamples-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.outputMCMCsamples</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">outputMCMCsamples(mme::MME,trmStrs::AbstractString...)</code></pre><p>Get MCMC samples for specific location parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.runMCMC-Tuple{JWAS.MME,Any}" href="#JWAS.runMCMC-Tuple{JWAS.MME,Any}"><code>JWAS.runMCMC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">runMCMC(model::MME,df::DataFrame;
        weight                   = false,
        ### MCMC
        chain_length             = 1000,
        starting_value           = false,
        burnin                   = 0,
        output_samples_frequency = chain_length/1000,
        output_samples_file      = &quot;MCMC_samples&quot;,
        update_priors_frequency  = 0,
        ### Methods
        methods                  = &quot;conventional (no markers)&quot;,
        estimate_variance        = true,
        Pi                       = 0.0,
        estimatePi               = false,
        estimateScale            = false,
        single_step_analysis     = false,
        pedigree                 = false,
        categorical_trait        = false,
        missing_phenotypes       = true,
        constraint               = false,
        causal_structure         = false,
        ### Genomic Prediction
        outputEBV                = true,
        output_heritability      = true,
        ### MISC
        seed                     = false,
        printout_model_info      = true,
        printout_frequency       = 0)</code></pre><p><strong>Run MCMC for Bayesian Linear Mixed Models with or without estimation of variance components.</strong></p><ul><li>Markov chain Monte Carlo<ul><li>The first <code>burnin</code> iterations are discarded at the beginning of a MCMC chain of length <code>chain_length</code>.</li><li>Save MCMC samples every <code>output_samples_frequency</code> iterations, defaulting to <code>chain_length/1000</code>, to files <code>output_samples_file</code>, defaulting to <code>MCMC_samples.txt</code>. MCMC samples for hyperparametes (variance componets) and marker effects are saved by default. MCMC samples for location parametes can be saved using <code>output_MCMC_samples()</code>. Note that saving MCMC samples too frequently slows down the computation.</li><li>The <code>starting_value</code> can be provided as a vector for all location parameteres and marker effects, defaulting to <code>0.0</code>s. The order of starting values for location parameters and marker effects should be the order of location parameters in the Mixed Model Equation for all traits (This can be obtained by getNames(model)) and then markers for all traits (all markers for trait 1 then all markers for trait 2...).</li><li>Miscellaneous Options<ul><li>Priors are updated every <code>update_priors_frequency</code> iterations, defaulting to <code>0</code>.</li></ul></li></ul></li><li>Methods<ul><li>Available <code>methods</code> include &quot;conventional (no markers)&quot;, &quot;RR-BLUP&quot;, &quot;BayesA&quot;, &quot;BayesB&quot;, &quot;BayesC&quot;, &quot;Bayesian Lasso&quot;, and &quot;GBLUP&quot;.</li><li>Single step analysis is allowed if <code>single_step_analysis</code> = <code>true</code> and <code>pedigree</code> is provided.</li><li>In Bayesian variable selection methods, <code>Pi</code> for single-trait analyses is a number; <code>Pi</code> for multi-trait analyses is a dictionary such as <code>Pi=Dict([1.0; 1.0]=&gt;0.7,[1.0; 0.0]=&gt;0.1,[0.0; 1.0]=&gt;0.1,[0.0; 0.0]=&gt;0.1)</code>, defaulting to <code>all markers have effects (Pi = 0.0)</code> in single-trait analysis and <code>all markers have effects on all traits (Pi=Dict([1.0; 1.0]=&gt;1.0,[0.0; 0.0]=&gt;0.0))</code> in multi-trait analysis. <code>Pi</code> is estimated if <code>estimatePi</code> = true, , defaulting to <code>false</code>.</li><li>Variance components are estimated if <code>estimate_variance</code>=true, defaulting to <code>true</code>.</li><li>Scale parameter for prior of marker effect variance is estimated if <code>estimateScale</code> = true, defaulting to <code>false</code>.</li><li>Miscellaneous Options<ul><li>Missing phenotypes are allowed in multi-trait analysis with <code>missing_phenotypes</code>=true, defaulting to <code>true</code>.</li><li>Catogorical Traits are allowed if <code>categorical_trait</code>=true, defaulting to <code>false</code>. Phenotypes should be coded as 1,2,3...</li><li>If <code>constraint</code>=true, defaulting to <code>false</code>, constrain residual covariances between traits to be zeros.</li><li>If <code>causal_structure</code> is provided, e.g., causal_structure = [0.0,0.0,0.0;1.0,0.0,0.0;1.0,0.0,0.0] for trait 2 -&gt; trait 1 and trait 3 -&gt; trait 1, phenotypic causal networks will be incorporated using structure equation models.</li></ul></li></ul></li><li>Genomic Prediction<ul><li>Individual estimted breeding values (EBVs) and prediction error variances (PEVs) are returned if <code>outputEBV</code>=true, defaulting to <code>true</code>. Heritability and genetic</li></ul>variances are returned if <code>output_heritability</code>=<code>true</code>, defaulting to <code>true</code>. Note that estimation of heritability is computaionally intensive.</li><li>Miscellaneous Options<ul><li>Print out the model information in REPL if <code>printout_model_info</code>=true; print out the monte carlo mean in REPL with <code>printout_frequency</code>, defaulting to <code>false</code>.</li><li>If <code>seed</code>, defaulting to <code>false</code>, is provided, a reproducible sequence of numbers will be generated for random number generation.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/JWAS.jl#L58-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}" href="#JWAS.set_covariate-Tuple{JWAS.MME,Vararg{AbstractString,N} where N}"><code>JWAS.set_covariate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">set_covariate(model::MME,variables::AbstractString...)</code></pre><ul><li>set <strong>variables</strong> as covariates; <strong>model</strong> is the output of function <code>build_model()</code>.</li></ul><pre><code class="language-julia">#After running build_model, variabels age and year can be set to be covariates as
set_covariate(model,&quot;age&quot;,&quot;year&quot;)
#or
set_covariate(model,&quot;age year&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/build_MME.jl#L71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.set_random" href="#JWAS.set_random"><code>JWAS.set_random</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_random(mme::MME,randomStr::AbstractString,G;Vinv=0,names=[],df=4)</code></pre><ul><li>set variables as random effects, defaulting to i.i.d effects, with variances <strong>G</strong>.</li><li><strong>G</strong> is the mean for the prior assigned for the variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes).</li><li>the random effects are assumed to be i.i.d by default and it can be defined with any (inverse of) covariance structure <strong>Vinv</strong> with its index (row names) provided by <strong>names</strong>.</li></ul><pre><code class="language-julia">#single-trait (i.i.d randome effects)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
G               = 0.6
set_random(model,&quot;litter&quot;,G)

#multi-trait (i.i.d randome effects)
model_equations = &quot;BW = intercept + litter + sex
                   CW = intercept + litter + sex&quot;
model           = build_model(model_equations,R);
G               = [3.72  1.84
                   1.84  3.41]
set_random(model,&quot;litter&quot;,G)

#single-trait (randome effects with specific covariance structures)
model_equation  = &quot;y = intercept + litter + sex&quot;
model           = build_model(model_equation,R)
V               = [1.0  0.5 0.25
                   0.5  1.0 0.5
                   0.25 0.5 1.0]
G               = 0.6
set_random(model,&quot;litter&quot;,G,Vinv=inv(V),names=[a1;a2;a3])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/random_effects.jl#L52-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.set_random" href="#JWAS.set_random"><code>JWAS.set_random</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_random(mme::MME,randomStr::AbstractString,ped::Pedigree, G;df=4)</code></pre><ul><li>set variables as random polygenic effects with pedigree information <strong>ped</strong>. and variances <strong>G</strong>.</li><li><strong>G</strong> is the mean for the prior assigned for the variance with degree of freedom <strong>df</strong>, defaulting to 4.0. If <strong>G</strong> is not provided, a value is calculated from responses (phenotypes).</li></ul><pre><code class="language-julia">#single-trait (example 1)
model_equation  = &quot;y = intercept + age + animal&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = 1.6
set_random(model,&quot;animal&quot;, ped, G)

#single-trait (example 2)
model_equation  = &quot;y = intercept + age + animal + animal*age&quot;
model           = build_model(model_equation,R)
ped             = get_pedigree(pedfile)
G               = [1.6   0.2
                   0.2  1.0]
set_random(model,&quot;animal animal*age&quot;, ped,G)

#multi-trait
model_equations = &quot;BW = intercept + age + sex + animal
                   CW = intercept + age + sex + animal&quot;
model           = build_model(model_equations,R);
ped             = get_pedigree(pedfile);
G               = [6.72   2.84
                   2.84  8.41]
set_random(model,&quot;animal&quot;,ped,G)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/random_effects.jl#L5-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.showMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.showMME</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">showMME(mme::MME,df::DataFrame)</code></pre><ul><li>Show left-hand side and right-hand side of mixed model equations (no markers).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/build_MME.jl#L282-L286">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.solve-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.solve</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">solve(mme::MME,df::DataFrame;solver=&quot;default&quot;,printout_frequency=100,tolerance = 0.000001,maxiter = 5000)</code></pre><ul><li>Solve the mixed model equations (no marker information) without estimating variance components.</li></ul><p>Available solvers include <code>default</code>, <code>Jacobi</code>, <code>Gauss-Seidel</code>, and <code>Gibbs sampler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/solver.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.add_term-Tuple{Any,AbstractString}" href="#JWAS.add_term-Tuple{Any,AbstractString}"><code>JWAS.add_term</code></a> — <span class="docstring-category">Method</span></header><section><div><p>add to model an extra term: imputation_residual</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/SSBR/SSBR.jl#L132-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.getMCMCinfo-Tuple{Any}" href="#JWAS.getMCMCinfo-Tuple{Any}"><code>JWAS.getMCMCinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getMCMCinfo(model::MME)</code></pre><ul><li>(internal function) Print out MCMC information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/JWAS.jl#L670-L674">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}" href="#JWAS.getMME-Tuple{JWAS.MME,DataFrames.DataFrame}"><code>JWAS.getMME</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Construct mixed model equations with</p><p>incidence matrix: X      ; response        : ySparse; left-hand side  : mmeLhs ; right-hand side : mmeLhs ;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/buildMME/build_MME.jl#L203-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.get_outputX_others-Tuple{Any,Any}" href="#JWAS.get_outputX_others-Tuple{Any,Any}"><code>JWAS.get_outputX_others</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_outputX_others(model)</code></pre><p>(internal function) Make incidence matrices for effects involved in calculation of EBV including J, ϵ, pedTrmVec except marker covariates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L206-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.output_MCMC_samples" href="#JWAS.output_MCMC_samples"><code>JWAS.output_MCMC_samples</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">output_MCMC_samples(mme,sol,vRes,G0,π=false,α=false,locusEffectVar=false,outfile=false)</code></pre><p>(internal function) Save MCMC samples every output<em>samples</em>frequency iterations to the text file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L328-L332">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.output_MCMC_samples_setup" href="#JWAS.output_MCMC_samples_setup"><code>JWAS.output_MCMC_samples_setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">output_MCMC_samples_setup(mme,nIter,output_samples_frequency,file_name=&quot;MCMC_samples&quot;)</code></pre><p>(internal function) Set up text files to save MCMC samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L234-L238">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}" href="#JWAS.output_location_parameters_samples-Tuple{JWAS.MME,Any,Any}"><code>JWAS.output_location_parameters_samples</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">output_location_parameters_samples(mme::MME,sol,outfile)</code></pre><p>(internal function) Save MCMC samples for location parameers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L396-L400">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.transubstrarr-Tuple{Any}" href="#JWAS.transubstrarr-Tuple{Any}"><code>JWAS.transubstrarr</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">transubstrarr(vec)</code></pre><p>(internal function) Transpose a column vector of strings (vec&#39; doesn&#39;t work here)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/1.JWAS/src/output.jl#L410-L414">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.PedModule.get_pedigree-Tuple{AbstractString}" href="#JWAS.PedModule.get_pedigree-Tuple{AbstractString}"><code>JWAS.PedModule.get_pedigree</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_pedigree(pedfile::AbstractString;header=false,separator=&#39;,&#39;)</code></pre><ul><li>Get pedigree informtion from a pedigree file with <strong>header</strong> (defaulting to <code>false</code>) and <strong>separator</strong> (defaulting to <code>,</code>).</li><li>Pedigree file format:</li></ul><pre><code class="language-none">a,0,0
c,a,b
d,a,c</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/2.PedModule/src/PedModule.jl#L10-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}" href="#JWAS.PedModule.getinfo-Tuple{JWAS.PedModule.Pedigree}"><code>JWAS.PedModule.getinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">get_info(pedigree::Pedigree)</code></pre><ul><li>Print summary informtion from a pedigree object including number of individulas, sires. dams and founders. Return individual IDs, inverse of numerator relationship matrix, and inbreeding coefficients.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/reworkhow/JWAS.jl/blob/feb53b90e520f11b386e259a33f4f07b2f0f0f6b/src/2.PedModule/src/PedModule.jl#L271-L277">source</a></section></article><p>–&gt;</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">« Public</a><a class="docs-footer-nextpage" href="../../examples/examples/">Examples »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 17 May 2020 23:34">Sunday 17 May 2020</span>. Using Julia version 1.1.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
